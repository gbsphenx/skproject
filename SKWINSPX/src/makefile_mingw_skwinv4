# MinGW32 SKWinV4 makefile
# 2024, Sphenx
# Required librairies : SDL
MAKE = mingw32-make

SKWIN_EXE = skwinv4-mingw
SKWIN_BUILD_FOLDER = ../build/SKWinV4_MinGW_Release
CC = g++
CFLAGS = -g -W -Wall -O3
CPPFLAGS = -DSK9821V4 -D__MINGW__ -D__SDL__ -D__SK_NO_ALLEGRO__ -Iv0 -Iv4 -Iv6 -I$(LUALIB_PATH)/include -I$(MINGW_PATH) -I$(SDLLIB_PATH)/include
LIBS = -L.. -L$(LUALIB_LIB) -L$(MINGW_LIB) -L$(SDLLIB_LIB)
LDFLAGS = $(MINGW_LDFLAGS)


OBJ = $(SKWIN_X_OBJ) $(SKWIN_CORE_OBJ) $(SKWIN_0_OBJ) $(SKWINXV6_OBJ)
OBJ_STATIC = $(LUALIB_OBJ) $(MINGW_OBJ) $(SDLLIB_OBJ)

#MINGW
MINGW_PATH = ../MinGW
MINGW_H = $(MINGW_PATH)/include
MINGW_LIB = $(MINGW_PATH)/lib
MINGW_OBJ = $(MINGW_LIB)/libws2_32.a
MINGW_LDFLAGS = -lws2_32

#SDL
SDLLIB_PATH = ../SDL2-2.0.8
SDLLIB_H = $(SDLLIB_PATH)/include/*.h
SDLLIB_LIB = $(SDLLIB_PATH)/lib/x86
SDLLIB_OBJ = $(SDLLIB_LIB)/SDL2.lib $(SDLLIB_LIB)/SDL2main.lib

#LUA
LUALIB_PATH = ../lua
LUALIB_H = $(LUALIB_PATH)/include/*.h
LUALIB_LIB = $(LUALIB_PATH)/lib
LUALIB_OBJ = $(LUALIB_LIB)/Lua5.1.lib

#BASE V0
SKWIN_0_PATH = v0
SKWIN_0_H = $(SKWIN_0_PATH)/*.h
SKWIN_0_OBJ = $(SKWIN_0_PATH)/skmfc.o $(SKWIN_0_PATH)/skwinmfc.o $(SKWIN_0_PATH)/skcnsole.o $(SKWIN_0_PATH)/skfile.o $(SKWIN_0_PATH)/skdos.o $(SKWIN_0_PATH)/sksdl2.o $(SKWIN_0_PATH)/skvram.o $(SKWIN_0_PATH)/skwinapp.o $(SKWIN_0_PATH)/skparam.o $(SKWIN_0_PATH)/skmidi.o $(SKWIN_0_PATH)/skdebug.o $(SKWIN_0_PATH)/skglobal.o $(SKWIN_0_PATH)/skrender.o

#ROOT
SKWIN_X_PATH = v4
SKWIN_X_H = $(SKWIN_X_PATH)/*.h
SKWIN_X_OBJ = $(SKWIN_X_PATH)/StdAfx.o $(SKWIN_X_PATH)/dme.o $(SKWIN_X_PATH)/sklua.o

#SKGAME V4
SKWIN_CORE_PATH = v4
SKWIN_CORE_H = $(SKWIN_CORE_PATH)/*.h
SKWIN_CORE_OBJ = $(SKWIN_CORE_PATH)/skmemcch.o $(SKWIN_CORE_PATH)/skfileop.o $(SKWIN_CORE_PATH)/skaudio.o $(SKWIN_CORE_PATH)/sksound.o $(SKWIN_CORE_PATH)/skbkgrnd.o $(SKWIN_CORE_PATH)/skbltgfx.o $(SKWIN_CORE_PATH)/skchamp.o $(SKWIN_CORE_PATH)/skcore.o $(SKWIN_CORE_PATH)/skcrture.o $(SKWIN_CORE_PATH)/skdevui.o $(SKWIN_CORE_PATH)/skdoor.o $(SKWIN_CORE_PATH)/skdungn.o $(SKWIN_CORE_PATH)/skeditdn.o $(SKWIN_CORE_PATH)/skevent.o $(SKWIN_CORE_PATH)/skgame.o $(SKWIN_CORE_PATH)/skgameui.o $(SKWIN_CORE_PATH)/skgdat.o $(SKWIN_CORE_PATH)/skguidrw.o $(SKWIN_CORE_PATH)/skibmio.o $(SKWIN_CORE_PATH)/skitem.o $(SKWIN_CORE_PATH)/sktext.o $(SKWIN_CORE_PATH)/skuievnt.o $(SKWIN_CORE_PATH)/skweathr.o


#EXTENSION
SKWINXV6_PATH = v6
SKWINXV6_H = $(SKWINXV6_PATH)/*.h
SKWINXV6_OBJ =  $(SKWINXV6_PATH)/xstartup.o $(SKWINXV6_PATH)/xcorelog.o $(SKWINXV6_PATH)/xcoreenh.o $(SKWINXV6_PATH)/xcoredm1.o $(SKWINXV6_PATH)/xsfxsdl.o


all: $(SKWIN_EXE)

$(SKWIN_EXE) : $(OBJ)
	$(CC) $(CFLAGS) $(CPPFLAGS) $(LIBS) $(LDFLAGS) $(OBJ) $(OBJ_STATIC) -o ${SKWIN_BUILD_FOLDER}/$(SKWIN_EXE)

clean: 
	rm $(OBJ)
