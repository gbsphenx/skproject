# MinGW32 SKWin-V5 makefile
# 2024-2025, Sphenx
# Required librairies : SDL, fmod, sdl_ttf, openGL, GLUT
MAKE = mingw32-make

SKWIN_EXE = skwinv5_mingw
SKWIN_BUILD_FOLDER = ../build/SkWinV4_MinGW_Release
CC = g++
CFLAGS = -g -W -Wall -O3
CPPFLAGS = -DSKWINSPX -D__MINGW__ -D__NOSDL__ -Iv6spxmex -Iv5bitdos -I$(LUALIB_PATH)/include -I$(MINGW_PATH) -I$(SDLLIB_PATH)/include
LIBS = -L.. -L$(LUALIB_LIB) -L$(MINGW_LIB) -L$(SDLLIB_LIB)
LDFLAGS = $(MINGW_LDFLAGS)


OBJ = $(SKWIN_X_OBJ) $(SKWIN_X2_OBJ) $(SKWIN_CORE_OBJ) $(SKWIN_VIDEO_OBJ) $(SKWIN_WINDOW_OBJ) $(SKWIN_AUDIO_OBJ) $(SKWINXV6_OBJ)
OBJ_STATIC = $(LUALIB_OBJ) $(MINGW_OBJ) $(SDLLIB_OBJ)

#MINGW
MINGW_PATH = ../MinGW
MINGW_H = $(MINGW_PATH)/include
MINGW_LIB = $(MINGW_PATH)/lib
MINGW_OBJ = $(MINGW_LIB)/libws2_32.a
MINGW_LDFLAGS = -lws2_32

#SDL
SDLLIB_PATH = ../SDL2-2.0.8
SDLLIB_H = $(SDLLIB_PATH)/include/*.h
SDLLIB_LIB = $(SDLLIB_PATH)/lib/x86
SDLLIB_OBJ = $(SDLLIB_LIB)/SDL2.lib $(SDLLIB_LIB)/SDL2main.lib

#LUA
LUALIB_PATH = ../lua
LUALIB_H = $(LUALIB_PATH)/include/*.h
LUALIB_LIB = $(LUALIB_PATH)/lib
LUALIB_OBJ = $(LUALIB_LIB)/Lua5.1.lib

#ROOT V5
SKWIN_X_PATH = v5bitdos
SKWIN_X_H = $(SKWIN_X_PATH)/*.h
SKWIN_X_OBJ = $(SKWIN_X_PATH)/types.o $(SKWIN_X_PATH)/unref.o $(SKWIN_X_PATH)/util.o $(SKWIN_X_PATH)/xtypes.o

#SPECIAL V5
SKWIN_X_PATH = v5bitdos
SKWIN_X_H = $(SKWIN_X_PATH)/*.h
SKWIN_X2_OBJ = $(SKWIN_X_PATH)/dm2data.o $(SKWIN_X_PATH)/dm2debug.o $(SKWIN_X_PATH)/DM2GLOBL.o $(SKWIN_X_PATH)/emu.o \
$(SKWIN_X_PATH)/fileio.o $(SKWIN_X_PATH)/ints.o $(SKWIN_X_PATH)/main.o $(SKWIN_X_PATH)/mdata.o \
$(SKWIN_X_PATH)/SK0AAF.o $(SKWIN_X_PATH)/SK1C9A.o $(SKWIN_X_PATH)/SK0350.o $(SKWIN_X_PATH)/SK1031.o $(SKWIN_X_PATH)/SKADDON.o

#VIDEO V%
SKWIN_VIDEO_PATH = v5bitdos
SKWIN_VIDEO_H = $(SKWIN_VIDEO_PATH)/*.h
SKWIN_VIDEO_OBJ = $(SKWIN_VIDEO_PATH)/GXFBLIT.o $(SKWIN_VIDEO_PATH)/GFXBMP.o $(SKWIN_VIDEO_PATH)/GFXDEC.o $(SKWIN_VIDEO_PATH)/GFXMAIN.o \
$(SKWIN_VIDEO_PATH)/GFXPAL.o $(SKWIN_VIDEO_PATH)/GFXPIXEL.o $(SKWIN_VIDEO_PATH)/GFXSTR.o $(SKWIN_VIDEO_PATH)/SKALEGRO.o

#BASE V5
SKWIN_CORE_PATH = v5bitdos
SKWIN_CORE_H = $(SKWIN_CORE_PATH)/*.h
SKWIN_CORE_OBJ = $(SKWIN_CORE_PATH)/SKAI.o $(SKWIN_CORE_PATH)/SKALLOC.o $(SKWIN_CORE_PATH)/SKALOCDB.o $(SKWIN_CORE_PATH)/BCREATUR.o \
$(SKWIN_CORE_PATH)/SKCLOUD.o $(SKWIN_CORE_PATH)/SKENGAGE.o $(SKWIN_CORE_PATH)/SKEVENTQ.o $(SKWIN_CORE_PATH)/SKEVENTS.o $(SKWIN_CORE_PATH)/SKGDTQDB.o \
$(SKWIN_CORE_PATH)/BGDAT.o $(SKWIN_CORE_PATH)/SKGUIDRW.o $(SKWIN_CORE_PATH)/SKGUIVWP.o $(SKWIN_CORE_PATH)/SKHERO.o $(SKWIN_CORE_PATH)/SKIMAGE.o \
$(SKWIN_CORE_PATH)/SKLIGHT.o $(SKWIN_CORE_PATH)/SKLODLVL.o $(SKWIN_CORE_PATH)/SKMAP.o $(SKWIN_CORE_PATH)/SKMCURSR.o $(SKWIN_CORE_PATH)/SKMOVE.o \
$(SKWIN_CORE_PATH)/SKMOVREC.o $(SKWIN_CORE_PATH)/SKRANDOM.o $(SKWIN_CORE_PATH)/SKRECORD.o $(SKWIN_CORE_PATH)/SKRECT.o $(SKWIN_CORE_PATH)/SKSTR.o \
$(SKWIN_CORE_PATH)/SKSVGAME.o $(SKWIN_CORE_PATH)/SKTIMER.o $(SKWIN_CORE_PATH)/SKTIMPRC.o $(SKWIN_CORE_PATH)/SKWEATHR.o $(SKWIN_CORE_PATH)/SKXRECT.o \
$(SKWIN_CORE_PATH)/UIBUTTON.o $(SKWIN_CORE_PATH)/UICLRECT.o $(SKWIN_CORE_PATH)/UIDIALOG.o $(SKWIN_CORE_PATH)/UIINPUT.o $(SKWIN_CORE_PATH)/UIKEYBD.o \
$(SKWIN_CORE_PATH)/UITMOUSE.o


#WINDOW V5
SKWIN_WINDOW_PATH = v5bitdos
SKWIN_WINDOW_H = $(SKWIN_WINDOW_PATH)/*.h
SKWIN_WINDOW_OBJ = $(SKWIN_WINDOW_PATH)/DOSVIDEO.o $(SKWIN_WINDOW_PATH)/startend.o


#AUDIO V5
SKWIN_AUDIO_PATH = v5bitdos
SKWIN_AUDIO_H = $(SKWIN_AUDIO_PATH)/*.h
SKWIN_AUDIO_OBJ = $(SKWIN_AUDIO_PATH)/SFX.o $(SKWIN_AUDIO_PATH)/SFXMIDI.o $(SKWIN_AUDIO_PATH)/SFXMUWAV.o $(SKWIN_AUDIO_PATH)/SFXSND.o

#BASE V6
SKWINXV6_PATH = v6spxmex
SKWINXV6_H = $(SKWINXV6_PATH)/*.h
SKWINXV6_OBJ =  $(SKWINXV6_PATH)/XSTARTUP.o $(SKWINXV6_PATH)/XCORELOG.o $(SKWINXV6_PATH)/XCOREENH.o $(SKWINXV6_PATH)/XCOREDM1.o $(SKWINXV6_PATH)/XCOREEXT.o $(SKWINXV6_PATH)/XCOREBWY.o $(SKWINXV6_PATH)/XSFXSDL.o


all: $(SKWIN_EXE)

$(SKWIN_EXE) : $(OBJ)
	$(CC) $(CFLAGS) $(CPPFLAGS) $(LIBS) $(LDFLAGS) $(OBJ) $(OBJ_STATIC) -o ${SKWIN_BUILD_FOLDER}/$(SKWIN_EXE)

clean: 
	rm -rf $(OBJ)
